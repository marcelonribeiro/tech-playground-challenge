{% extends "base.html" %}

{% block content %}
<div class="row mb-5">
    <div class="col-12 text-center">
        <h2 class="fw-light text-secondary">API <span class="fw-bold text-dark">Reference</span></h2>
        <p class="text-muted">Comprehensive guide to consuming Pin People Analytics data programmatically.</p>
    </div>
</div>

<div class="row">
    <div class="col-md-3 mb-4">
        <div class="sticky-top" style="top: 2rem; z-index: 1;">
            <div class="list-group shadow-sm">
                <a href="#intro" class="list-group-item list-group-item-action fw-bold">Introduction</a>
                <a href="#employees" class="list-group-item list-group-item-action">List Employees</a>
                <a href="#company" class="list-group-item list-group-item-action">Company Metrics</a>
                <a href="#departments" class="list-group-item list-group-item-action">Departments</a>
                <a href="#sentiment" class="list-group-item list-group-item-action">Sentiment Overview</a>
            </div>
        </div>
    </div>

    <div class="col-md-9">
        
        <section id="intro" class="mb-5">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h4 class="card-title fw-bold">Getting Started</h4>
                    <p>The API is built using REST principles. All responses are in JSON format.</p>
                    <hr>
                    <h6 class="fw-bold">Base URL</h6>
                    <code class="bg-light p-2 rounded d-block mb-3">http://localhost:5000/api/v1</code>
                    
                    <h6 class="fw-bold">Testing with cURL</h6>
                    <p class="small text-muted">You can test any endpoint using your terminal:</p>
                    <pre class="bg-dark text-white p-3 rounded"><code>curl -X GET http://localhost:5000/api/v1/departments</code></pre>
                </div>
            </div>
        </section>

        <section id="employees" class="mb-5">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white py-3">
                    <span class="badge bg-primary me-2">GET</span>
                    <span class="fw-bold font-monospace">/employees</span>
                </div>
                <div class="card-body">
                    <p>Retrieves a paginated list of employees with optional filtering.</p>
                    
                    <h6 class="mt-4 text-secondary">Query Parameters</h6>
                    <table class="table table-sm table-bordered">
                        <thead class="table-light"><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><code>page</code></td><td>int</td><td>Page number (default: 1)</td></tr>
                            <tr><td><code>per_page</code></td><td>int</td><td>Items per page (default: 10)</td></tr>
                            <tr><td><code>department_id</code></td><td>int</td><td>Filter by Department ID</td></tr>
                            <tr><td><code>role</code></td><td>string</td><td>Filter by Role name (partial match)</td></tr>
                        </tbody>
                    </table>

                    <h6 class="mt-4 text-secondary">Response Example</h6>
                    <pre class="bg-light p-3 rounded small"><code>{
  "items": [
    {
      "id": 101,
      "name": "Alice Johnson",
      "email": "alice@example.com",
      "role": "Data Scientist",
      "department": "Engineering"
    }
  ],
  "total": 50,
  "page": 1,
  "per_page": 10,
  "pages": 5
}</code></pre>
                </div>
            </div>
        </section>

        <section id="company" class="mb-5">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white py-3">
                    <span class="badge bg-primary me-2">GET</span>
                    <span class="fw-bold font-monospace">/dashboard/company</span>
                </div>
                <div class="card-body">
                    <p>Returns high-level KPI metrics for the executive dashboard.</p>
                    
                    <h6 class="mt-4 text-secondary">Response Example</h6>
                    <pre class="bg-light p-3 rounded small"><code>{
  "total_employees": 150,
  "participation_rate": 85.5,
  "company_enps": {
    "score": 45,
    "promoters": 80,
    "detractors": 10,
    "total_responses": 128
  }
}</code></pre>
                </div>
            </div>
        </section>

        <section id="departments" class="mb-5">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white py-3">
                    <span class="badge bg-primary me-2">GET</span>
                    <span class="fw-bold font-monospace">/departments</span>
                </div>
                <div class="card-body">
                    <p>Helper endpoint to fetch all available departments. Useful for populating dropdowns.</p>
                    
                    <h6 class="mt-4 text-secondary">Response Example</h6>
                    <pre class="bg-light p-3 rounded small"><code>[
  { "id": 1, "name": "Engineering" },
  { "id": 2, "name": "Human Resources" },
  { "id": 3, "name": "Sales" }
]</code></pre>
                </div>
            </div>
        </section>

        <section id="sentiment" class="mb-5">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white py-3">
                    <span class="badge bg-primary me-2">GET</span>
                    <span class="fw-bold font-monospace">/analytics/sentiment-overview</span>
                </div>
                <div class="card-body">
                    <p>Aggregates AI-driven sentiment analysis grouped by comment category.</p>

                    <h6 class="mt-4 text-secondary">Query Parameters</h6>
                    <table class="table table-sm table-bordered">
                        <thead class="table-light"><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><code>department_id</code></td><td>int</td><td>Optional. Filter analysis by department.</td></tr>
                        </tbody>
                    </table>
                    
                    <h6 class="mt-4 text-secondary">Response Example</h6>
                    <pre class="bg-light p-3 rounded small"><code>{
  "department_id": null,
  "metrics": [
    {
      "field_name": "manager_interaction_comment",
      "friendly_label": "Manager Bond",
      "average_rating": 2.1,
      "sample_size": 45,
      "distribution": {
        "POSITIVE": 5,
        "NEUTRAL": 10,
        "NEGATIVE": 30
      }
    }
  ]
}</code></pre>
                </div>
            </div>
        </section>

    </div>
</div>
{% endblock %}